<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas de Histología - Universidad Autónoma de Sinaloa</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --uas-azul: #003f7f;
            --uas-dorado: #d4af37;
            --uas-blanco: #ffffff;
            --uas-gris: #6c757d;
            --uas-azul-claro: #4a90e2;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, var(--uas-azul) 0%, var(--uas-azul-claro) 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            padding: 1rem 0;
            box-shadow: 0 4px 25px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--uas-dorado);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-uas {
            width: 80px;
            height: 80px;
            background: var(--uas-azul);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--uas-dorado);
            font-size: 2rem;
            font-weight: bold;
            border: 3px solid var(--uas-dorado);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .title-section h1 {
            color: var(--uas-azul);
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }

        .title-section p {
            color: var(--uas-gris);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .search-container {
            flex: 1;
            max-width: 400px;
            margin: 0 2rem;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 12px 50px 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 30px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--uas-azul);
            box-shadow: 0 0 0 3px rgba(0, 63, 127, 0.1);
        }

        .search-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(45deg, var(--uas-azul), var(--uas-azul-claro));
            color: white;
            border: none;
            border-radius: 50%;
            width: 38px;
            height: 38px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .search-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 4px 15px rgba(0,63,127,0.3);
        }

        .stats {
            background: linear-gradient(45deg, var(--uas-dorado), #f4d03f);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 15px;
            text-align: center;
            min-width: 130px;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }

        .stats-number {
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .stats-label {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .main-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .filters {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            padding: 2rem;
            border-radius: 25px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            border-top: 4px solid var(--uas-dorado);
        }

        .filter-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--uas-azul);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .filter-btn {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            color: var(--uas-gris);
        }

        .filter-btn:hover, .filter-btn.active {
            background: linear-gradient(45deg, var(--uas-azul), var(--uas-azul-claro));
            color: white;
            border-color: var(--uas-azul);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,63,127,0.3);
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .image-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 10px 35px rgba(0,0,0,0.15);
            transition: all 0.4s ease;
            cursor: pointer;
            backdrop-filter: blur(15px);
            border-top: 4px solid var(--uas-dorado);
        }

        .image-card:hover {
            transform: translateY(-15px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.25);
        }

        .image-wrapper {
            position: relative;
            overflow: hidden;
            aspect-ratio: 4/3;
            background: #f8f9fa;
        }

        .image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.4s ease;
        }

        .image-card:hover .image-wrapper img {
            transform: scale(1.1);
        }

        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(0, 63, 127, 0.9), rgba(212, 175, 55, 0.8));
            opacity: 0;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-card:hover .image-overlay {
            opacity: 1;
        }

        .overlay-content {
            text-align: center;
            color: white;
        }

        .overlay-content i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .overlay-content p {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--uas-azul);
            margin-bottom: 0.8rem;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-category {
            display: inline-block;
            background: linear-gradient(45deg, var(--uas-dorado), #f4d03f);
            color: white;
            padding: 6px 14px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .card-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--uas-gris);
            font-size: 0.85rem;
        }

        .card-info i {
            margin-right: 5px;
            color: var(--uas-azul);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 25px;
            max-width: 95vw;
            max-height: 95vh;
            overflow-y: auto;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
        }

        .modal-header {
            background: linear-gradient(45deg, var(--uas-azul), var(--uas-azul-claro));
            color: white;
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.8rem;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .modal-body {
            padding: 2rem;
            text-align: center;
        }

        .modal-image {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 2rem;
        }

        .modal-info {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 20px;
            margin-top: 1.5rem;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            text-align: left;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0.8rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-item i {
            color: var(--uas-azul);
            width: 20px;
        }

        .no-results {
            text-align: center;
            padding: 4rem 2rem;
            color: white;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .no-results i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--uas-dorado);
        }

        .loading {
            text-align: center;
            padding: 4rem;
            color: white;
        }

        .loading i {
            font-size: 3rem;
            animation: spin 2s linear infinite;
            color: var(--uas-dorado);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            margin-top: 4rem;
            padding: 3rem 2rem 2rem;
            border-top: 4px solid var(--uas-dorado);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .footer-header h2 {
            color: var(--uas-azul);
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .footer-year {
            color: var(--uas-dorado);
            font-size: 1.2rem;
            font-weight: bold;
        }

        .authors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .author-section {
            background: rgba(0, 63, 127, 0.05);
            padding: 1.5rem;
            border-radius: 15px;
            border-left: 4px solid var(--uas-azul);
        }

        .author-section h3 {
            color: var(--uas-azul);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .author-name {
            color: #333;
            font-weight: 600;
            margin-bottom: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .author-name:last-child {
            border-bottom: none;
        }

        .pending-authors {
            background: rgba(212, 175, 55, 0.1);
            border-left-color: var(--uas-dorado);
        }

        .student-section {
            background: linear-gradient(45deg, var(--uas-azul), var(--uas-azul-claro));
            color: white;
            text-align: center;
            padding: 2rem;
            border-radius: 20px;
            margin: 2rem 0;
        }

        .student-section h3 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .student-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--uas-dorado);
        }

        .footer-disclaimer {
            text-align: center;
            color: var(--uas-gris);
            font-size: 0.9rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #dee2e6;
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                text-align: center;
            }

            .logo-section {
                flex-direction: column;
                gap: 15px;
            }

            .search-container {
                margin: 1rem 0;
                max-width: 100%;
            }

            .filter-buttons {
                justify-content: center;
            }

            .gallery {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .modal-content {
                max-width: 98vw;
                max-height: 98vh;
                margin: 1vh;
            }

            .authors-grid {
                grid-template-columns: 1fr;
            }

            .modal-header {
                padding: 1.5rem;
            }

            .modal-body {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <div class="logo-section">
                <div class="logo-uas">UAS</div>
                <div class="title-section">
                    <h1>Atlas de Histología</h1>
                    <p>Universidad Autónoma de Sinaloa</p>
                </div>
            </div>
            
            <div class="search-container">
                <input type="text" class="search-box" id="searchInput" placeholder="Buscar estructuras histológicas...">
                <button class="search-btn" onclick="performSearch()">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <div class="stats">
                <div class="stats-number" id="totalImages">0</div>
                <div class="stats-label">Preparaciones</div>
            </div>
        </div>
    </header>

    <div class="main-container">
        <div class="filters">
            <div class="filter-title">
                <i class="fas fa-layer-group"></i>
                Sistemas y Tejidos
            </div>
            <div class="filter-buttons" id="filterButtons">
                <button class="filter-btn active" data-filter="all">
                    <i class="fas fa-th"></i>
                    Todas las preparaciones
                </button>
            </div>
        </div>

        <div class="gallery" id="gallery">
            <div class="loading">
                <i class="fas fa-microscope"></i>
                <p>Cargando atlas histológico...</p>
            </div>
        </div>

        <div class="no-results" id="noResults" style="display: none;">
            <i class="fas fa-search-minus"></i>
            <h3>No se encontraron preparaciones</h3>
            <p>Intenta con otros términos de búsqueda o explora diferentes categorías</p>
        </div>
    </div>

    <!-- Modal para visualizar imágenes -->
    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Preparación Histológica</div>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <img class="modal-image" id="modalImage" src="" alt="">
                <div class="modal-info">
                    <div class="info-grid" id="modalInfo">
                        <!-- Información dinámica -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-header">
                <h2>Atlas de Histología UAS</h2>
                <div class="footer-year">2025</div>
            </div>

            <div class="authors-grid">
                <div class="author-section">
                    <h3><i class="fas fa-users"></i> Responsables del Programa</h3>
                    <div class="author-name">Dr. Jesús Alberto Cortez Hernández</div>
                    <div class="author-name">Dra. María de la Paz Espinoza Benítez</div>
                    <div class="author-name">MC. Ernesto Armienta Aldana</div>
                    <div class="author-name">Biól. José Ángel Cervantes Pompa</div>
                </div>

                <div class="author-section pending-authors">
                    <h3><i class="fas fa-user-plus"></i> Colaboradores Adicionales</h3>
                    <div class="author-name" style="color: #888; font-style: italic;">Profesor/a por confirmar</div>
                    <div class="author-name" style="color: #888; font-style: italic;">Profesor/a por confirmar</div>
                </div>
            </div>

            <div class="student-section">
                <h3><i class="fas fa-graduation-cap"></i> Desarrollado por</h3>
                <div class="student-name">Jesús Raymundo Vega Bonilla</div>
            </div>

            <div class="footer-disclaimer">
                <p><strong>Atlas de Histología UAS 2025</strong></p>
                <p>Material educativo desarrollado para el estudio de la histología en la Universidad Autónoma de Sinaloa</p>
                <p>Las imágenes histológicas están destinadas exclusivamente para fines educativos y de investigación</p>
            </div>
        </div>
    </footer>

    <script>
        let histologyData = [];
        let filteredData = [];
        let currentFilter = 'all';
        let currentSearch = '';

        // Cargar datos del JSON o usar datos de ejemplo
        async function loadHistologyData() {
            try {
                const response = await fetch('datos_histologia.json');
                if (response.ok) {
                    histologyData = await response.json();
                    console.log('Datos cargados desde JSON:', histologyData.length, 'imágenes');
                } else {
                    throw new Error('JSON no disponible');
                }
            } catch (error) {
                console.log('Generando datos de ejemplo...');
                generateSampleData();
            }
            
            processCategories();
            filteredData = [...histologyData];
            renderGallery();
            updateStats();
        }

        // Generar datos de ejemplo basados en las imágenes existentes
        function generateSampleData() {
            const categories = [
                'Tejido Epitelial',
                'Tejido Conectivo',
                'Sistema Inmunitario',
                'Tejido Muscular',
                'Tejido Nervioso',
                'Aparato Urinario',
                'Aparato Genital Masculino',
                'Aparato Genital Femenino',
                'Histología General'
            ];

            const structures = [
                'Epitelio estratificado plano',
                'Epitelio simple cilíndrico',
                'Tejido conectivo laxo',
                'Cartílago hialino',
                'Tejido óseo',
                'Ganglio linfático',
                'Bazo',
                'Músculo esquelético',
                'Músculo cardíaco',
                'Músculo liso',
                'Médula espinal',
                'Corteza cerebral',
                'Glomérulo renal',
                'Túbulo renal',
                'Vejiga urinaria',
                'Testículo',
                'Epidídimo',
                'Ovario',
                'Útero',
                'Glándula mamaria'
            ];

            // Generar datos para las 54 imágenes que tienes
            for (let i = 1; i <= 54; i++) {
                const ext = (i >= 33 && i <= 49) ? '.gif' : '.jpg';
                const fileName = `img${i.toString().padStart(4, '0')}${ext}`;
                const category = categories[Math.floor(Math.random() * categories.length)];
                const structure = structures[Math.floor(Math.random() * structures.length)];
                
                histologyData.push({
                    titulo: `${structure} - Preparación ${i}`,
                    imagen: fileName,
                    categoria: category,
                    descripcion: `Corte histológico de ${structure.toLowerCase()}. Técnica de tinción H&E.`,
                    tamaño_bytes: Math.floor(Math.random() * 800000) + 100000,
                    pagina_origen: `https://wzar.unizar.es/acad/histologia/paginas/${category.replace(' ', '')}/`,
                    magnificacion: `${Math.floor(Math.random() * 9 + 1)}00x`,
                    tincion: Math.random() > 0.7 ? 'Tricrómica de Masson' : 'Hematoxilina-Eosina'
                });
            }
        }

        // Procesar categorías únicas
        function processCategories() {
            const categories = [...new Set(histologyData.map(item => {
                return item.categoria || extractCategoryFromPath(item.pagina_origen) || 'General';
            }))].sort();

            const filterButtons = document.getElementById('filterButtons');
            const allButton = filterButtons.querySelector('[data-filter="all"]');
            
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'filter-btn';
                button.dataset.filter = category;
                
                // Iconos específicos para cada categoría
                const categoryIcons = {
                    'Tejido Epitelial': 'fas fa-border-all',
                    'Tejido Conectivo': 'fas fa-project-diagram',
                    'Sistema Inmunitario': 'fas fa-shield-alt',
                    'Tejido Muscular': 'fas fa-dumbbell',
                    'Tejido Nervioso': 'fas fa-brain',
                    'Aparato Urinario': 'fas fa-kidneys',
                    'Aparato Genital Masculino': 'fas fa-mars',
                    'Aparato Genital Femenino': 'fas fa-venus',
                    'Histología General': 'fas fa-microscope'
                };
                
                const icon = categoryIcons[category] || 'fas fa-tag';
                button.innerHTML = `<i class="${icon}"></i> ${category}`;
                button.onclick = () => filterByCategory(category);
                filterButtons.appendChild(button);
            });
        }

        // Extraer categoría de la ruta
        function extractCategoryFromPath(path) {
            if (!path) return null;
            
            const categoryMap = {
                'TejEpitelial': 'Tejido Epitelial',
                'TejConectivo': 'Tejido Conectivo',
                'SistInmune': 'Sistema Inmunitario',
                'TejMuscular': 'Tejido Muscular',
                'TejNervioso': 'Tejido Nervioso',
                'ApUrin': 'Aparato Urinario',
                'ApGenMasc': 'Aparato Genital Masculino',
                'ApGenFem': 'Aparato Genital Femenino'
            };

            for (const [key, value] of Object.entries(categoryMap)) {
                if (path.includes(key)) return value;
            }
            return 'Histología General';
        }

        // Renderizar galería
        function renderGallery() {
            const gallery = document.getElementById('gallery');
            const noResults = document.getElementById('noResults');

            if (filteredData.length === 0) {
                gallery.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }

            noResults.style.display = 'none';
            gallery.innerHTML = filteredData.map((item, index) => `
                <div class="image-card" onclick="openModal(${index})">
                    <div class="image-wrapper">
                        <img src="imagenes/${item.imagen}" alt="${item.titulo}" 
                             onerror="handleImageError(this)">
                        <div class="image-overlay">
                            <div class="overlay-content">
                                <i class="fas fa-search-plus"></i>
                                <p>Ver preparación</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="card-category">${item.categoria || 'General'}</div>
                        <h3 class="card-title">${item.titulo}</h3>
                        <div class="card-info">
                            <span><i class="fas fa-image"></i> ${item.imagen}</span>
                            <span><i class="fas fa-weight"></i> ${formatFileSize(item.tamaño_bytes || 0)}</span>
                        </div>
                    </div>
